import angr

# load your project
p = angr.Project('data/train/malware/Backdoor.Win32.Bladabindi.bpu-cab3b22f726935519d4631ff6a6868b27c84777a6b6b7f13c2ca3e75219e5131', load_options={'auto_load_libs': False})

# Generate a static CFG
cfg = p.analyses.CFGFast()
print("This is the graph:", cfg.graph)
print("It has %d nodes and %d edges" % (len(cfg.graph.nodes()), len(cfg.graph.edges())))

# generate a dynamic CFG
cfg = p.analyses.CFGEmulated(keep_state=True)
print("This is the graph:", cfg.graph)
print("It has %d nodes and %d edges" % (len(cfg.graph.nodes()), len(cfg.graph.edges())))