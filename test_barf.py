from barf import BARF

# Open binary file.
barf = BARF("data/train/malware/Backdoor.Win32.Bladabindi.bos-5d575fee309c2eaeeed460d93dfe353e505c0fae0a77d6c3997b36e4b7d42123")

# Print assembly instruction.
for addr, asm_instr, reil_instrs in barf.translate():
    print("{:#x} {}".format(addr, asm_instr))

    # Print REIL translation.
    for reil_instr in reil_instrs:
        print("\t{}".format(reil_instr))

# # Recover CFG.
# cfg = barf.recover_cfg()

# # Save CFG to a .dot file.
# cfg.save("./dot/amstream.dll_cfg")
